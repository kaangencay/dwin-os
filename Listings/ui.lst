C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE UI
OBJECT MODULE PLACED IN .\Objects\ui.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE source\ui.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\driver;.\source) DEB
                    -UG OBJECTEXTEND PRINT(.\Listings\ui.lst) TABS(2) OBJECT(.\Objects\ui.obj)

line level    source

   1          #include "ui.h"
   2          #include "uart.h"
   3          #include "vars.h"
   4          #include "timer.h"
   5          #include "MYModBus.h"
   6          #include "string.h"
   7          #include "stdlib.h"
   8          
   9          void P0Func(void)
  10          {
  11   1          Contorl();
  12   1          Touch_Scan_0();
  13   1      
  14   1      }
  15          
  16          void P1Func(void)//1 - 6
  17          { 
  18   1          Polling1_6();
  19   1          Touch_Scan_1_2_6();
  20   1      }
  21          void P2Func(void)
  22          {
  23   1          Polling1_6();
  24   1          Touch_Scan_1_2_6();
  25   1      }
  26          
  27          void P3Func(void)
  28          {
  29   1          Touch_Scan_3();
  30   1          Coordinate_Control();//Âà†Èô§ÂíåÁ°ÆËÆ§
  31   1                      
  32   1          File_Control();//ËØªÊñá‰ª∂Êìç‰Ωú    
  33   1      }
  34          void P4Func(void)
  35          {
  36   1          Touch_Scan_4();
  37   1      }
  38          
  39          void P5Func(void)
  40          {
  41   1          Touch_Scan_5();
  42   1          Touch_Scan_1_2_6();
  43   1      }
  44          void P9Func(void)
  45          {
  46   1          gCtrlPara.Icon_InitFlag = 0;;//ËØªÁä∂ÊÄÅÊ†áÂøó
  47   1                
  48   1          gCtrlPara.VendxCount = 0;//ËØªVendxÊ†áÂøó
  49   1      
  50   1          gCtrlPara.LED_NOWFlag = 1;//ËØª‰∫ÆÂ∫¶Ê†áÂøó
  51   1      }
  52          
  53          void P10_12Func(void)
  54          {
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 2   

  55   1          Polling10_12();
  56   1          Touch_Scan_10_12();
  57   1      }
  58          
  59          void P13Func(void)
  60          {
  61   1        Touch_Scan_13();
  62   1      }
  63          
  64          void P14Func(void)
  65          {
  66   1        Touch_Scan_14();
  67   1      }
  68          
  69          //ÂØÜÁ†Å
  70          void P16Func(void)
  71          {
  72   1        Touch_Scan_16();
  73   1      }
  74          
  75          //ÈîÅ-Êó∂Èó¥
  76          void P18Func(void)
  77          {
  78   1      //  Touch_Scan_18();
  79   1      }
  80          
  81          void P15_17Func(void)
  82          {
  83   1          Polling15_17();
  84   1      
  85   1      }
  86          code void (*PagePointer[])(u16 pageid)={
  87                    P0Func,P1Func,P2Func,P3Func,P4Func,P5Func,P1Func,0,0,P9Func,P10_12Func,
  88                    0,P10_12Func,P13Func,P14Func,P15_17Func,P16Func,P15_17Func,P18Func
  89          };
  90          
  91          void PageFunction(void)
  92          {
  93   1        u16 pageid;
  94   1      
  95   1        EA = 0;
  96   1        ADR_H = 0x00;
  97   1        ADR_M = 0x00;
  98   1        ADR_L = 0x0a;
  99   1        ADR_INC = 1;
 100   1        RAMMODE = 0xAF;   //ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ
 101   1        while(!APP_ACK);
 102   1        APP_EN = 1;
 103   1        while(APP_EN);
 104   1        pageid = DATA3;
 105   1        pageid <<= 8;
 106   1        pageid |= DATA2;
 107   1        RAMMODE = 0;
 108   1        EA = 1;
 109   1        if(PagePointer[pageid] != 0)
 110   1        {
 111   2          PagePointer[pageid](pageid);
 112   2        } 
 113   1      }
 114          
 115          //Êè°ÊâãÂíåÊï∞ÊçÆÊòæÁ§∫
 116          void Contorl(void)
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 3   

 117          {
 118   1            if(gCtrlPara.Shake_handFlag == 0)
 119   1            {   
 120   2                gTime3++;
 121   2                if(gTime3 >= 50)
 122   2                {
 123   3                    gTime3 = 0;
 124   3                    HOST_Addr = HOST_Shake_hands;
 125   3                    Send_ModBus(0x03,HOST_Shake_hands,0x0000,0x01);//Êè°Êâã 
 126   3                  
 127   3                    gCtrlPara.Cartoon = 0;//Âä®Áîª
 128   3                    sys_write_vp(0x100E,(u8*)&gCtrlPara.Cartoon,1);//Âä®ÁîªÂºÄÂßã
 129   3                    
 130   3                    gCtrlPara.Cartoon = 1;//Âä®Áîª
 131   3                    sys_write_vp(0x100A,(u8*)&gCtrlPara.Cartoon,1);//Âä®ÁîªÂÅúÊ≠¢
 132   3                    sys_write_vp(0x100C,(u8*)&gCtrlPara.Cartoon,1);//Âä®ÁîªÂÅúÊ≠¢
 133   3                }
 134   2          }
 135   1          else
 136   1          {
 137   2              if(gCtrlPara.PowerOn_ResetFlag == 0)
 138   2              {
 139   3                gTime3++;
 140   3                if(gTime3 >= 50)
 141   3                {
 142   4                    gTime3 = 0;
 143   4                    HOST_Addr = HOST_Power_On_Reset;
 144   4                    Send_ModBus(0x03,HOST_Power_On_Reset,0x0000,0x01);//Â§ç‰Ωç  
 145   4                      
 146   4                      gCtrlPara.Cartoon = 0;//Âä®Áîª            
 147   4                      sys_write_vp(0x100C,(u8*)&gCtrlPara.Cartoon,1);//Âä®ÁîªÂºÄÂßã
 148   4      //                sys_write_vp(0x100A,(u8*)&gCtrlPara.Cartoon,1);//Âä®ÁîªÂºÄÂßã
 149   4                }       
 150   3              }
 151   2          }
 152   1      
 153   1      }
 154          
 155          //ËΩÆËØ¢ËØªÂèñÊï∞ÊçÆ
 156          void Polling1_6(void)
 157          {
 158   1          if(gCtrlPara.Shake_handFlag == 1) //Êè°ÊâãÊàêÂäüËØªÂèñÊï∞ÊçÆ
 159   1          {   
 160   2                  if(gCtrlPara.WorkSta == 0x0001)//ËøêË°å
 161   2                {                 
 162   3                    switch(gCtrlPara.Flag)
 163   3                    {
 164   4                      case 0:
 165   4                        HOST_Addr = HMI_WorkSta;
 166   4                        
 167   4                        Send_ModBus(0x03,HOST_WorkSta,0x0000,0x01);////Â∑•‰ΩúÁä∂ÊÄÅ
 168   4                        gTime4++;
 169   4                        if(gTime4 >5)
 170   4                        {
 171   5                          gCtrlPara.Flag = 1;
 172   5                          gTime4 = 0;
 173   5                        }
 174   4                      break;                        
 175   4                      case 1:
 176   4                        HOST_Addr = HMI_Read_X_Value;
 177   4                        Send_ModBus(0x03,HOST_Read_X_Value,0x0000,0x02);//ËØªXÂùêÊ†á
 178   4                        gTime4++;
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 4   

 179   4                        if(gTime4 >5)
 180   4                        {
 181   5                          gCtrlPara.Flag = 2;
 182   5                          gTime4 = 0;
 183   5                        }
 184   4                      break;
 185   4                      case 2:
 186   4                        HOST_Addr = HMI_Read_Y_Value;
 187   4                        Send_ModBus(0x03,HOST_Read_Y_Value,0x0000,0x02);//ËØªyÂùêÊ†á
 188   4                        gTime4++;
 189   4                        if(gTime4 >5)
 190   4                        {
 191   5                          gCtrlPara.Flag = 3;
 192   5                          gTime4 = 0;
 193   5                        }
 194   4                      break;
 195   4                      case 3:
 196   4                        HOST_Addr = HMI_Read_Z_Value;
 197   4                        Send_ModBus(0x03,HOST_Read_Z_Value,0x0000,0x02);//ËØªZÂùêÊ†á
 198   4                        gTime4++;
 199   4                        if(gTime4 >5)
 200   4                        {
 201   5                          gCtrlPara.Flag = 4;
 202   5                          gTime4 = 0;
 203   5                        }
 204   4                      break;
 205   4                      case 4:
 206   4                        HOST_Addr = HOST_Limit_Infor;
 207   4                        Send_ModBus(0x03,HOST_Limit_Infor,0x0000,0x01);//Èôê‰ΩçÁ≠âÊä•Ë≠¶‰ø°ÊÅØ
 208   4                        gTime4++;
 209   4                        if(gTime4 >5)
 210   4                        {
 211   5                          gCtrlPara.Flag = 5;
 212   5                          gTime4 = 0;
 213   5                        }
 214   4                      break;
 215   4                      case 5:
 216   4                        HOST_Addr = HMI_Work_TimeC;
 217   4                        Send_ModBus(0x03,HOST_Work_TimeC,0x0000,0x01);//Âä†Â∑•Êó∂Èó¥0x001C-0x001E
 218   4                        gTime4++;
 219   4                        if(gTime4 >5)
 220   4                        {
 221   5                          gCtrlPara.Flag = 6;
 222   5                          gTime4 = 0;
 223   5                        }
 224   4                      break;
 225   4                      case 6:
 226   4                        HOST_Addr = HMI_Work_TimeD;
 227   4                        Send_ModBus(0x03,HOST_Work_TimeD,0x0000,0x01);//Âä†Â∑•Êó∂Èó¥0x001C-0x001E
 228   4                        gTime4++;
 229   4                        if(gTime4 >5)
 230   4                        {
 231   5                          gCtrlPara.Flag = 7;
 232   5                          gTime4 = 0;
 233   5                        }
 234   4                      break;
 235   4                      case 7:
 236   4                        HOST_Addr = HMI_Work_TimeE;
 237   4                        Send_ModBus(0x03,HOST_Work_TimeE,0x0000,0x01);//Âä†Â∑•Êó∂Èó¥0x001C-0x001E
 238   4                        gTime4++;
 239   4                        if(gTime4 >5)
 240   4                        {
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 5   

 241   5                          gCtrlPara.Flag = 8;
 242   5                          gTime4 = 0;
 243   5                        }
 244   4                      break;
 245   4                      case 8:
 246   4                        HOST_Addr = HMI_Processing_Speed;
 247   4                        Send_ModBus(0x03,HOST_Processing_Speed,0x0000,0x01);//Âä†Â∑•ÈÄüÂ∫¶
 248   4                        gTime4++;
 249   4                        if(gTime4 >5)
 250   4                        {
 251   5                          gCtrlPara.Flag = 9;
 252   5                          gTime4 = 0;
 253   5                        }
 254   4                      break;
 255   4                      case 9:
 256   4      //                        HOST_Addr = HMI_U_Coordinate;   
 257   4      //                        Send_ModBus(0x03,HOST_U_Coordinate,0x0000,0x04);//UÊòæÁ§∫
 258   4                        gTime4++;
 259   4                        if(gTime4 >5)
 260   4                        {
 261   5                          gCtrlPara.Flag = 10;
 262   5                          gTime4 = 0;
 263   5                        }
 264   4                                            
 265   4                      break;
 266   4                      case 10:
 267   4                        gCtrlPara.Flag =0;
 268   4                      break;
 269   4                    }
 270   3                }
 271   2                // && (gCtrlPara.SendFlag <= 2)
 272   2                else if((gCtrlPara.SendFlag == 1) && (gCtrlPara.WorkSta != 0x0001))//ËøêË°å
 273   2                {
 274   3                    switch(gCtrlPara.FreeFlag)
 275   3                    {
 276   4                      case 0:               
 277   4                        if(gCtrlPara.GO_Focusing == 1)
 278   4                        {
 279   5                            gCtrlPara.FreeFlag = 1;
 280   5                        }
 281   4                        else
 282   4                        {
 283   5                          HOST_Addr = HMI_WorkSta;
 284   5                          Send_ModBus(0x03,HOST_WorkSta,0x0000,0x01);////Â∑•‰ΩúÁä∂ÊÄÅ
 285   5                          gTime4++;
 286   5                          if(gTime4 >5)
 287   5                          {
 288   6                            gCtrlPara.FreeFlag = 1;
 289   6                            gTime4 = 0;
 290   6                          }
 291   5                        }                   
 292   4                      break;
 293   4                      case 1:
 294   4                          gCtrlPara.FreeFlag = 2;
 295   4                      break;                        
 296   4                      case 2:
 297   4                        HOST_Addr = HMI_Read_X_Value;
 298   4                        Send_ModBus(0x03,HOST_Read_X_Value,0x0000,0x02);//ËØªXÂùêÊ†á
 299   4                        gTime4++;
 300   4                        if(gTime4 >5)
 301   4                        {
 302   5                          gCtrlPara.FreeFlag = 3;
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 6   

 303   5                          gTime4 = 0;
 304   5                        }
 305   4                      break;
 306   4                      case 3:
 307   4                        HOST_Addr = HMI_Read_Y_Value;
 308   4                        Send_ModBus(0x03,HOST_Read_Y_Value,0x0000,0x02);//ËØªyÂùêÊ†á
 309   4                        gTime4++;
 310   4                        if(gTime4 >5)
 311   4                        {
 312   5                          gCtrlPara.FreeFlag = 4;
 313   5                          gTime4 = 0;
 314   5                        }
 315   4                      break;
 316   4                      case 4:
 317   4                        HOST_Addr = HMI_Read_Z_Value;
 318   4                        Send_ModBus(0x03,HOST_Read_Z_Value,0x0000,0x02);//ËØªZÂùêÊ†á
 319   4                        gTime4++;
 320   4                        if(gTime4 >5)
 321   4                        {
 322   5                          gCtrlPara.FreeFlag = 5;
 323   5                          gTime4 = 0;
 324   5                        }
 325   4                      break;
 326   4                      case 5:
 327   4                        if(gCtrlPara.GO_Focusing == 1)
 328   4                        {
 329   5                            gCtrlPara.FreeFlag = 6;
 330   5                        }
 331   4                        else
 332   4                        {
 333   5                          HOST_Addr = HMI_Current_File_Name;
 334   5                          Send_ModBus(0x03,HOST_Current_File_Name,0x0000,0x04);//ÂΩìÂâçÊñá‰ª∂Âêç0x0010-0x0013
 335   5                          gTime4++;
 336   5                          if(gTime4 >5)
 337   5                          {
 338   6                            gCtrlPara.FreeFlag = 6;
 339   6                            gTime4 = 0;
 340   6                          }
 341   5                        }
 342   4                      break;
 343   4                      case 6:
 344   4                          if(gCtrlPara.GO_Focusing == 1)
 345   4                          {
 346   5                            HOST_Addr = HMI_Go_Border;
 347   5                            Send_ModBus(0x03,HOST_Go_Border,0x0000,0x01);//‰∏ãÂèëËß¶Êéß   
 348   5                          }
 349   4                          else
 350   4                          {
 351   5                              gCtrlPara.FreeFlag = 7;
 352   5                          }
 353   4                      break;                            
 354   4                      case 7:
 355   4      //                          HOST_Addr = HMI_U_Coordinate;   
 356   4      //                          Send_ModBus(0x03,HOST_U_Coordinate,0x0000,0x04);//UÊòæÁ§∫
 357   4                        gTime4++;
 358   4                        if(gTime4 >5)
 359   4                        {
 360   5                          gCtrlPara.FreeFlag = 8;
 361   5                          gTime4 = 0;
 362   5                        }
 363   4                      
 364   4                      break;
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 7   

 365   4                        
 366   4                      case 8:
 367   4                        HOST_Addr = HOST_Limit_Infor;
 368   4                        Send_ModBus(0x03,HOST_Limit_Infor,0x0000,0x01);//Èôê‰ΩçÁ≠âÊä•Ë≠¶‰ø°ÊÅØ
 369   4                        gTime4++;
 370   4                        if(gTime4 >5)
 371   4                        {
 372   5                          gCtrlPara.FreeFlag = 9;
 373   5                          gTime4 = 0;
 374   5                        }
 375   4                      break;  
 376   4                      case 9:
 377   4                        gCtrlPara.FreeFlag = 0;
 378   4                        gCtrlPara.SendFlag++;
 379   4                      break;
 380   4                    }
 381   3                }
 382   2                else if(gCtrlPara.SendFlag > 1)
 383   2                {
 384   3                  gCtrlPara.SendFlag++;
 385   3                  if(gCtrlPara.SendFlag > 50)
 386   3                  {
 387   4                    gCtrlPara.SendFlag = 1; 
 388   4                  }
 389   3                }
 390   2      
 391   2          }
 392   1      }
 393          
 394          //ËΩÆËØ¢ËØªÂèñÊï∞ÊçÆ
 395          void Polling2(void)
 396          {
 397   1          if(gCtrlPara.Shake_handFlag == 1) //Êè°ÊâãÊàêÂäüËØªÂèñÊï∞ÊçÆ
 398   1          {   
 399   2                
 400   2          }
 401   1      }
 402          
 403          
 404          void Polling10_12(void)
 405          {
 406   1          if(gCtrlPara.Shake_handFlag == 1) //Êè°ÊâãÊàêÂäüËØªÂèñÊï∞ÊçÆ
 407   1          {   
 408   2              if(gCtrlPara.VendxCount < 2)
 409   2              {
 410   3                  switch(gCtrlPara.IconCount)
 411   3                  {   
 412   4                    case 0:
 413   4                        HOST_Addr = 0x0051;
 414   4                        Send_ModBus(0x03,0x0051,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
 415   4                        gTime4++;
 416   4                        if(gTime4 >5)
 417   4                        {
 418   5                          gCtrlPara.IconCount = 1;
 419   5                          gTime4 = 0;
 420   5                        }
 421   4                      break;
 422   4                    
 423   4                    case 1:
 424   4                        HOST_Addr = 0x0052;
 425   4                        Send_ModBus(0x03,0x0052,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
 426   4                        gTime4++;
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 8   

 427   4                        if(gTime4 >5)
 428   4                        {
 429   5                          gCtrlPara.IconCount = 2;
 430   5                          gTime4 = 0;
 431   5                        }
 432   4                      break;
 433   4                    
 434   4                    case 2:
 435   4                        HOST_Addr = 0x0053;
 436   4                        Send_ModBus(0x03,0x0053,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
 437   4                        gTime4++;
 438   4                        if(gTime4 >5)
 439   4                        {
 440   5                          gCtrlPara.IconCount = 3;
 441   5                          gTime4 = 0;
 442   5                        }
 443   4                      break;
 444   4                    
 445   4                    case 3:
 446   4                        HOST_Addr = 0x0054;
 447   4                        Send_ModBus(0x03,0x0054,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
 448   4                        gTime4++;
 449   4                        if(gTime4 >5)
 450   4                        {
 451   5                          gCtrlPara.IconCount = 4;
 452   5                          gTime4 = 0;
 453   5                        }
 454   4                      break;
 455   4                    
 456   4                    case 4:
 457   4                        HOST_Addr = 0x0055;
 458   4                        Send_ModBus(0x03,0x0055,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
 459   4                        gTime4++;
 460   4                        if(gTime4 >5)
 461   4                        {
 462   5                          gCtrlPara.IconCount = 5;
 463   5                          gTime4 = 0;
 464   5                        }
 465   4                      break;
 466   4                    
 467   4                    case 5:
 468   4                        HOST_Addr = 0x0056;
 469   4                        Send_ModBus(0x03,0x0056,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
 470   4                        gTime4++;
 471   4                        if(gTime4 >5)
 472   4                        {
 473   5                          gCtrlPara.IconCount = 6;
 474   5                          gTime4 = 0;
 475   5                        }
 476   4                      break;
 477   4                    
 478   4                    case 6:
 479   4                        gCtrlPara.IconCount = 0;
 480   4                        gCtrlPara.VendxCount++;
 481   4                        if(gCtrlPara.VendxCount >1)
 482   4                        {
 483   5                            gCtrlPara.VendxCount = 2;
 484   5                        }
 485   4                      break;
 486   4                  }
 487   3              }
 488   2          }
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 9   

 489   1      }
 490          
 491          
 492          void Polling15_17(void)
 493          {
 494   1          
 495   1          if(gCtrlPara.Shake_handFlag == 1) //Êè°ÊâãÊàêÂäüËØªÂèñÊï∞ÊçÆ
 496   1          {   
 497   2                        if(gCtrlPara.VendxINFO < 2)
 498   2                        {
 499   3                            switch(gCtrlPara.IconCount)
 500   3                            {   
 501   4                              case 0:
 502   4                                  HOST_Addr = 0x0032;
 503   4                                  Send_ModBus(0x03,0x0032,0x0000,0x02);//‰∏ãÂèëËß¶Êéß  ‰∏ªÊùø‰ø°ÊÅØ
 504   4                                  gTime4++;
 505   4                                  if(gTime4 >5)
 506   4                                  {
 507   5                                    gCtrlPara.IconCount = 1;
 508   5                                    gTime4 = 0;
 509   5                                  }
 510   4                                break;
 511   4                              
 512   4                              case 1:
 513   4                                  HOST_Addr = 0x0465;
 514   4                                  Send_ModBus(0x03,0x0465,0x0000,0x02);//‰∏ãÂèëËß¶Êéß Á¥ØËÆ°ÂºÄÊú∫Êó∂Èó¥
 515   4                                  gTime4++;
 516   4                                  if(gTime4 >5)
 517   4                                  {
 518   5                                    gCtrlPara.IconCount = 2;
 519   5                                    gTime4 = 0;
 520   5                                  }
 521   4                                break;
 522   4                              
 523   4                              case 2:
 524   4                                  HOST_Addr = 0x0467;
 525   4                                  Send_ModBus(0x03,0x0467,0x0000,0x02);//‰∏ãÂèëËß¶Êéß Á¥ØËÆ°Âä†Â∑•Êó∂Èó¥
 526   4                                  gTime4++;
 527   4                                  if(gTime4 >5)
 528   4                                  {
 529   5                                    gCtrlPara.IconCount = 3;
 530   5                                    gTime4 = 0;
 531   5                                  }
 532   4                                break;
 533   4                              
 534   4                              case 3:
 535   4                                  HOST_Addr = 0x0469;
 536   4                                  Send_ModBus(0x03,0x0469,0x0000,0x02);//‰∏ãÂèëËß¶Êéß ÂâçÊ¨°Âä†Â∑•Êó∂Èó¥
 537   4                                  gTime4++;
 538   4                                  if(gTime4 >5)
 539   4                                  {
 540   5                                    gCtrlPara.IconCount = 4;
 541   5                                    gTime4 = 0;
 542   5                                  }
 543   4                                break;
 544   4                              
 545   4                              case 4:
 546   4                                  HOST_Addr = 0x046B;
 547   4                                  Send_ModBus(0x03,0x046B,0x0000,0x02);//‰∏ãÂèëËß¶Êéß Á¥ØËÆ°Âá∫ÂÖâÊó∂Èó¥
 548   4                                  gTime4++;
 549   4                                  if(gTime4 >5)
 550   4                                  {
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 10  

 551   5                                    gCtrlPara.IconCount = 5;
 552   5                                    gTime4 = 0;
 553   5                                  }
 554   4                                break;
 555   4                                                              
 556   4                              case 5:
 557   4                                  HOST_Addr = 0x046D;
 558   4                                  Send_ModBus(0x03,0x046D,0x0000,0x02);//‰∏ãÂèëËß¶Êéß  Á¥ØËÆ°Âä†Â∑•Ê¨°Êï∞
 559   4                                  gTime4++;
 560   4                                  if(gTime4 >5)
 561   4                                  {
 562   5                                    gCtrlPara.IconCount = 6;
 563   5                                    gTime4 = 0;
 564   5                                  }
 565   4                                break;
 566   4      
 567   4                                //01 03 04 0A 00 01 A5 38                             
 568   4                              case 6:
 569   4                                  HOST_Addr = 0x046F;
 570   4                                  Send_ModBus(0x03,0x046F,0x0000,0x02);//‰∏ãÂèëËß¶Êéß  XËΩ¥Á¥ØËÆ°Ë°åÁ®ã
 571   4                                  gTime4++;
 572   4                                  if(gTime4 >5)
 573   4                                  {
 574   5                                    gCtrlPara.IconCount = 7;
 575   5                                    gTime4 = 0;
 576   5                                  }
 577   4                                break;
 578   4      
 579   4                              //01 03 04 0B 00 01 F4 F8                           
 580   4                              case 7:
 581   4                                  HOST_Addr = 0x0471;
 582   4                                  Send_ModBus(0x03,0x0471,0x0000,0x02);//‰∏ãÂèëËß¶Êéß YËΩ¥Á¥ØËÆ°Ë°åÁ®ã
 583   4                                  gTime4++;
 584   4                                  if(gTime4 >5)
 585   4                                  {
 586   5                                    gCtrlPara.IconCount = 8;
 587   5                                    gTime4 = 0;
 588   5                                  }
 589   4                                break;  
 590   4       
 591   4      //                        //01 03 04 0C 00 02 05 38                           
 592   4      //                        case 8:
 593   4      //                            HOST_Addr = 0x040C;
 594   4      //                            Send_ModBus(0x03,0x040C,0x0000,0x04);//‰∏ãÂèëËß¶Êéß  Á≥ªÁªüÈîÅÂÆöÊó∂Èó¥
 595   4      //                            gTime4++;
 596   4      //                            if(gTime4 >5)
 597   4      //                            {
 598   4      //                              gCtrlPara.IconCount = 9;
 599   4      //                              gTime4 = 0;
 600   4      //                            }
 601   4      //                          break;
 602   4                            
 603   4                              case 8:
 604   4      
 605   4                                  gCtrlPara.IconCount = 0;
 606   4                                  gCtrlPara.VendxINFO++;
 607   4                                  if(gCtrlPara.VendxINFO >1)
 608   4                                  {
 609   5                                      gCtrlPara.VendxINFO = 2;
 610   5                                  }
 611   4                                break;
 612   4                            }
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 11  

 613   3                        }   
 614   2                        else
 615   2                        {
 616   3                          gCtrlPara.VendxINFO++;
 617   3                          if(gCtrlPara.VendxINFO >200)
 618   3                          {
 619   4                              gCtrlPara.VendxINFO = 0;
 620   4                          }
 621   3                
 622   3                        }
 623   2          }
 624   1      }
 625          
 626          void Touch_Scan_0(void)
 627          {
 628   1        u8 i;
 629   1          //ÂÅúÊ≠¢Â§ç‰Ωç
 630   1          for(i = 0;i < 5;i++)
 631   1          {
 632   2            sys_read_vp(RuiDa_ACS,(u8*)&gCtrlPara.Stop,1);  //ËØªËß¶Êéß
 633   2          }
 634   1          if(gCtrlPara.Stop == 0x005A)      
 635   1          {
 636   2            sys_read_vp(RuiDa_ACS,(u8*)&gCtrlPara.Stop,1);  //ËØªËß¶Êéß
 637   2            if(gCtrlPara.Stop == 0x005A)
 638   2            {                     
 639   3                Send_ModBus(0x05,0x0003,0xFF00,0x00); //‰∏ãÂèëËß¶Êéß
 640   3                gCtrlPara.Stop = 0;
 641   3                sys_write_vp(RuiDa_ACS,(u8*)&gCtrlPara.Stop,1);//Ëß¶ÊéßÊ∏ÖÈõ∂
 642   3            }
 643   2          }
 644   1      }
 645          
 646          
 647          void Touch_Scan_3(void)
 648          {
 649   1        u8 i;
 650   1        u8 j;     
 651   1                            //Êñá‰ª∂ÂõæÊ†áÊòæÁ§∫1
 652   1                            for(i = 0;i < 7;i++)
 653   1                            {
 654   2                              sys_read_vp(HMI_Key_Control+i,(u8*)&gCtrlPara.File_Icon,1); //ËØªËß¶Êéß
 655   2                            
 656   2                                if(gCtrlPara.File_Icon == 0x0001)     
 657   2                                {
 658   3                                    for(j = 0;j < 7;j++)
 659   3                                    {
 660   4                                      sys_write_vp(HMI_File_Icon + j,(u8*)&gCtrlPara.File_IconHis,1);//ÂõæÊ†áÊ∏ÖÈõ∂   
 661   4                                    }
 662   3      
 663   3                                    sys_write_vp(HMI_File_Icon + i,(u8*)&gCtrlPara.File_Icon,1);//ÂõæÊ†áÂÜô1  
 664   3                                    gCtrlPara.File_IconNum = i+1;//ÂΩìÂâçÁïåÈù¢Êñá‰ª∂Âè∑
 665   3                                    gCtrlPara.File_Num = gCtrlPara.Number_Control*7 + gCtrlPara.File_IconNum;//ÈÄâ‰∏≠Êñá‰ª∂Ê†áÂ
             -è∑
 666   3                                    
 667   3                                    
 668   3                                    sys_write_vp(HMI_Key_Control + i,(u8*)&gCtrlPara.File_IconHis,1);//Ëß¶ÊéßÊ∏ÖÈõ∂   
 669   3                                }
 670   2                            }
 671   1                            
 672   1                            //ËØªÂΩìÂâçÊéßÂà∂È°µ
 673   1                            for(i = 0;i < 5;i++)
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 12  

 674   1                            {
 675   2                              sys_read_vp(HMI_Current_Control,(u8*)&gCtrlPara.Current_Control,1);
 676   2                            }             
 677   1                            if(gCtrlPara.Current_Control != gCtrlPara.Current_ControlHis)
 678   1                            {
 679   2                              gCtrlPara.Number_Control = gCtrlPara.Current_Control -1;
 680   2                              
 681   2                              if(gCtrlPara.Number_Control <= gCtrlPara.Integer)
 682   2                              {
 683   3                                gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó  
 684   3                              }
 685   2                              else
 686   2                              {
 687   3                                gCtrlPara.Current_ControlHis = gCtrlPara.Current_Control;
 688   3                              }
 689   2                              
 690   2                              gCtrlPara.File_Num = gCtrlPara.Number_Control*7 + gCtrlPara.File_IconNum ;//ÈÄâ‰∏≠Êñá‰ª∂Ê†áÂè∑
 691   2                                                      
 692   2                                                      
 693   2                            }
 694   1                        
 695   1                                      
 696   1      }
 697          
 698          void Touch_Scan_4(void)
 699          {
 700   1        
 701   1        u8 i;
 702   1                      gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
 703   1                      gCtrlPara.Icon_InitFlag = 0;;//ËØªÁä∂ÊÄÅÊ†áÂøó
 704   1                      gCtrlPara.VendxINFO = 0;//ËØªINFOÊ†áÂøó
 705   1                
 706   1                      //Â§ç‰Ωç
 707   1                      for(i = 0;i < 5;i++)
 708   1                      {
 709   2                        sys_read_vp(HMI_Reset_Enter,(u8*)&gCtrlPara.Reset,1); //ËØªËß¶Êéß
 710   2                      }
 711   1                      if(gCtrlPara.Reset == 0x0001)     
 712   1                      {
 713   2                        sys_read_vp(HMI_Reset_Enter,(u8*)&gCtrlPara.Reset,1); //ËØªËß¶Êéß
 714   2                        if(gCtrlPara.Reset == 0x0001)
 715   2                        {               
 716   3                            gCtrlPara.Shake_handFlag = 0;
 717   3                            gCtrlPara.PowerOn_ResetFlag = 0;
 718   3                            Page_Change(0x00);
 719   3                          
 720   3                            gCtrlPara.Reset = 0;
 721   3                            sys_write_vp(HMI_Reset_Enter,(u8*)&gCtrlPara.Reset,1);//Ëß¶ÊéßÊ∏ÖÈõ∂
 722   3                        }
 723   2                      }
 724   1                      
 725   1                      //3301
 726   1                      for(i = 0;i < 5;i++)
 727   1                      {
 728   2                        sys_read_vp(0x3301,(u8*)&gCtrlPara.Reset,1);  //ËØªËß¶Êéß
 729   2                      }
 730   1                      if(gCtrlPara.Reset == 0x0001)     
 731   1                      {
 732   2                        sys_read_vp(0x3301,(u8*)&gCtrlPara.Reset,1);  //ËØªËß¶Êéß
 733   2                        if(gCtrlPara.Reset == 0x0001)
 734   2                        {                     
 735   3                            Page_Change(0x08);
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 13  

 736   3                          
 737   3                            gCtrlPara.Reset = 0;
 738   3                            sys_write_vp(0x3301,(u8*)&gCtrlPara.Reset,1);//Ëß¶ÊéßÊ∏ÖÈõ∂
 739   3                        }
 740   2                      }
 741   1                      
 742   1                      //ËØªIP
 743   1                      for(i = 0;i < 5;i++)
 744   1                      {
 745   2                        sys_read_vp(HMI_Read_WIFI_IP,(u8*)&gCtrlPara.Read_IP,1);  //ËØªËß¶Êéß
 746   2                      }
 747   1                      if(gCtrlPara.Read_IP == 0x005A)     
 748   1                      {
 749   2      
 750   2                        sys_read_vp(HMI_Read_WIFI_IP,(u8*)&gCtrlPara.Read_IP,1);  //ËØªËß¶Êéß
 751   2                        if(gCtrlPara.Read_IP == 0x005A)
 752   2                        {
 753   3                            HOST_Addr = HMI_Read_WIFI_IP;
 754   3                          
 755   3                            Send_ModBus(0x03,HOST_Read_WIFI_IP,0x0000,0x04);//‰∏ãÂèëËß¶Êéß
 756   3                            gCtrlPara.Read_IP = 0;
 757   3                            sys_write_vp(HMI_Read_WIFI_IP,(u8*)&gCtrlPara.Read_IP,1);//Ëß¶ÊéßÊ∏ÖÈõ∂   
 758   3                        }       
 759   2                      }
 760   1      
 761   1      }
 762          
 763          void Touch_Scan_5(void)
 764          {
 765   1        u8 i;
 766   1                        //ÁÇπÂ∞Ñ(Á¨¨‰∏ÄÊ¨°)
 767   1                        for(i = 0;i < 5;i++)
 768   1                        {
 769   2                          sys_read_vp(0x200B,(u8*)&gCtrlPara.On,1); //ËØªËß¶Êéß
 770   2                        }
 771   1                        if(gCtrlPara.On == 0x005A)      
 772   1                        {
 773   2                          sys_read_vp(0x200B,(u8*)&gCtrlPara.On,1); //ËØªËß¶Êéß
 774   2                          if(gCtrlPara.On == 0x005A)
 775   2                          {
 776   3                            gCtrlPara.TouchFlag = 1;
 777   3                              Send_ModBus(0x05,0x0013,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
 778   3                              gCtrlPara.On = 0;
 779   3                              sys_write_vp(0x200B,(u8*)&gCtrlPara.On,1);//Ëß¶ÊéßÊ∏ÖÈõ∂                    
 780   3                          }       
 781   2                        }
 782   1                        
 783   1                        //ÁÇπÂ∞ÑÔºàÊùæÂºÄÔºâ
 784   1                        for(i = 0;i < 5;i++)
 785   1                        {
 786   2                          sys_read_vp(0x200C,(u8*)&gCtrlPara.On,1); //ËØªËß¶Êéß
 787   2                        }
 788   1                        if(gCtrlPara.On == 0x005A)      
 789   1                        {
 790   2                          sys_read_vp(0x200C,(u8*)&gCtrlPara.On,1); //ËØªËß¶Êéß
 791   2                          if(gCtrlPara.On == 0x005A)
 792   2                          {
 793   3                            gCtrlPara.TouchFlag = 1;
 794   3                              Send_ModBus(0x05,0x0013,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
 795   3                              gCtrlPara.On = 0;
 796   3                              sys_write_vp(0x200C,(u8*)&gCtrlPara.On,1);//Ëß¶ÊéßÊ∏ÖÈõ∂  
 797   3                          }       
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 14  

 798   2                        }
 799   1                  
 800   1      }
 801          
 802          void Touch_Scan_1_2_6(void)
 803          {
 804   1        
 805   1        u8 i;
 806   1                        gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
 807   1      
 808   1                
 809   1                        //Ëµ∞ËæπÊ°Ü //0x1018
 810   1                        for(i = 0;i < 5;i++)
 811   1                        {
 812   2                          sys_read_vp(HMI_Go_Border,(u8*)&gCtrlPara.Go_Border,1); //ËØªËß¶Êéß
 813   2                        }
 814   1                        if(gCtrlPara.Go_Border == 0x005A)     
 815   1                        {
 816   2                          sys_read_vp(HMI_Go_Border,(u8*)&gCtrlPara.Go_Border,1); //ËØªËß¶Êéß
 817   2                          if(gCtrlPara.Go_Border == 0x005A)
 818   2                          {
 819   3                            gCtrlPara.TouchFlag = 1;
 820   3                            HOST_Addr = HMI_Go_Border;
 821   3                            gCtrlPara.GO_Focusing = 1;
 822   3                            
 823   3                            Send_ModBus(0x05,HOST_Start_Go_Border,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
 824   3                            gCtrlPara.Go_Border = 0;
 825   3                            sys_write_vp(HMI_Go_Border,(u8*)&gCtrlPara.Go_Border,1);//Ëß¶ÊéßÊ∏ÖÈõ∂
 826   3                          }       
 827   2                        }
 828   1                        
 829   1                        //ÂÆö‰ΩçÁÇπ101B
 830   1                        for(i = 0;i < 5;i++)
 831   1                        {
 832   2                          sys_read_vp(HMI_Anchor_Point,(u8*)&gCtrlPara.Anchor_Point,1); //ËØªËß¶Êéß
 833   2                        }
 834   1                        if(gCtrlPara.Anchor_Point == 0x005A)      
 835   1                        {
 836   2                          sys_read_vp(HMI_Anchor_Point,(u8*)&gCtrlPara.Anchor_Point,1); //ËØªËß¶Êéß
 837   2                          if(gCtrlPara.Anchor_Point == 0x005A)
 838   2                          {
 839   3                              Send_ModBus(0x05,HOST_Anchor_Point,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
 840   3                              gCtrlPara.Anchor_Point = 0;
 841   3                              sys_write_vp(HMI_Anchor_Point,(u8*)&gCtrlPara.Anchor_Point,1);//Ëß¶ÊéßÊ∏ÖÈõ∂    
 842   3                          }       
 843   2                        }
 844   1                              
 845   1                        //ÂêØÂä®/ÊöÇÂÅú
 846   1                        for(i = 0;i < 5;i++)
 847   1                        {
 848   2                          sys_read_vp(HMI_Start_Stoptouch,(u8*)&gCtrlPara.Start_Stoptouch,1); //ËØªËß¶Êéß
 849   2                        }
 850   1                        if(gCtrlPara.Start_Stoptouch == 0x5A)     
 851   1                        {
 852   2                          sys_read_vp(HMI_Start_Stoptouch,(u8*)&gCtrlPara.Start_Stoptouch,1); //ËØªËß¶Êéß
 853   2                          if(gCtrlPara.Start_Stoptouch == 0x5A)
 854   2                          { 
 855   3                            Send_ModBus(0x05,0x0000,0xFF00,0x00); //‰∏ãÂèëËß¶Êéß
 856   3                            gCtrlPara.Start_Stoptouch = 0;
 857   3                            sys_write_vp(HMI_Start_Stoptouch,(u8*)&gCtrlPara.Start_Stoptouch,1);//Ëß¶ÊéßÊ∏ÖÈõ∂    
 858   3                            
 859   3                            gCtrlPara.SendFlag = 1; 
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 15  

 860   3                            if((gCtrlPara.WorkSta == 0) || (gCtrlPara.WorkSta == 3) || (gCtrlPara.WorkSta == 5))
 861   3                            {
 862   4      //                      gCtrlPara.WorkSta = 1;//ËøêË°å                        
 863   4                              gCtrlPara.Start_Stop = 1;
 864   4                              sys_write_vp(HMI_Start_Stop,(u8*)&gCtrlPara.Start_Stop,1);//ÂõæÊ†áÊòæÁ§∫
 865   4                            }
 866   3                            else
 867   3                            {
 868   4      //                      gCtrlPara.WorkSta = 3;//ÊöÇÂÅú                      
 869   4                              gCtrlPara.Start_Stop = 0;
 870   4                              sys_write_vp(HMI_Start_Stop,(u8*)&gCtrlPara.Start_Stop,1);//ÂõæÊ†áÊòæÁ§∫
 871   4                            }
 872   3      
 873   3                          }       
 874   2                        }
 875   1                        
 876   1                        
 877   1                        //ÂÅúÊ≠¢(Â∑•‰ΩúÁä∂ÊÄÅ‰∏∫Á©∫Èó≤)
 878   1                        for(i = 0;i < 5;i++)
 879   1                        {
 880   2                          sys_read_vp(HMI_Stop,(u8*)&gCtrlPara.Stop,1); //ËØªËß¶Êéß
 881   2                        }
 882   1                        if(gCtrlPara.Stop == 1)     
 883   1                        {
 884   2                          sys_read_vp(HMI_Stop,(u8*)&gCtrlPara.Stop,1); //ËØªËß¶Êéß
 885   2                          if(gCtrlPara.Stop == 1)
 886   2                          {  
 887   3                              Send_ModBus(0x05,0x0003,0xFF00,0x00); //‰∏ãÂèëËß¶Êéß
 888   3                              gCtrlPara.Stop = 0;
 889   3                              sys_write_vp(HMI_Stop,(u8*)&gCtrlPara.Stop,1);//Ëß¶ÊéßÊ∏ÖÈõ∂  
 890   3                              gCtrlPara.SendFlag = 1; 
 891   3                            
 892   3                              gCtrlPara.Start_Stop = 0;
 893   3                              sys_write_vp(HMI_Start_Stop,(u8*)&gCtrlPara.Start_Stop,1);//ÂõæÊ†áÊòæÁ§∫
 894   3                              
 895   3                              gCtrlPara.WorkTimeH = 0;
 896   3                              sys_write_vp(HMI_Work_TimeC,(u8*)&gCtrlPara.WorkTimeH,1);
 897   3                              gCtrlPara.WorkTimeM = 0;
 898   3                              sys_write_vp(HMI_Work_TimeD,(u8*)&gCtrlPara.WorkTimeM,1);
 899   3                              gCtrlPara.WorkTimeS = 0;
 900   3                              sys_write_vp(HMI_Work_TimeE,(u8*)&gCtrlPara.WorkTimeS,1);
 901   3                            
 902   3                              gCtrlPara.Processing_Speed = 0;
 903   3                              sys_write_vp(HMI_Processing_Speed,(u8*)&gCtrlPara.Processing_Speed,1);//Âä†Â∑•ÈÄüÂ∫¶ÊòæÁ§∫
 904   3                            
 905   3                              Page_Change(0x01);
 906   3        
 907   3      //                    gCtrlPara.Cartoon = 0;//Âä®Áîª
 908   3      //                    sys_write_vp(HMI_Cartoon,(u8*)&gCtrlPara.Cartoon,1);//Âä®ÁîªÂÅúÊ≠¢
 909   3                            
 910   3                            gCtrlPara.GO_Focusing = 0;//Ëµ∞ËæπÊ°Ü-ÂØªÁÑ¶
 911   3                          }       
 912   2                        }
 913   1      
 914   1                        //‰∏ä(Á¨¨‰∏ÄÊ¨°)
 915   1                        for(i = 0;i < 5;i++)
 916   1                        {
 917   2                          sys_read_vp(0x2002,(u8*)&gCtrlPara.On,1); //ËØªËß¶Êéß
 918   2                        }
 919   1                        if(gCtrlPara.On == 0x005A)      
 920   1                        {
 921   2                          sys_read_vp(0x2002,(u8*)&gCtrlPara.On,1); //ËØªËß¶Êéß
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 16  

 922   2                          if(gCtrlPara.On == 0x005A)
 923   2                          {                     
 924   3                              Send_ModBus(0x05,0x0004,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
 925   3                              delay_ms(50);
 926   3                              Send_ModBus(0x05,0x0004,0x0000,0x00);
 927   3                              gCtrlPara.On = 0;
 928   3                              sys_write_vp(0x2002,(u8*)&gCtrlPara.On,1);//Ëß¶ÊéßÊ∏ÖÈõ∂    
 929   3      
 930   3                              StartTimer(3, 500);
 931   3                              gCtrlPara.SendFlag = 1; 
 932   3                          }       
 933   2                        }
 934   1                        
 935   1                        if (GetTimeOutFlag(3))
 936   1                        {
 937   2                          Send_ModBus(0x05,0x0004,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
 938   2                          //KillTimer(3);
 939   2                          //StartTimer(3, 50);
 940   2                        }
 941   1                        
 942   1                        //‰∏äÔºàÊùæÂºÄÔºâ
 943   1                        for(i = 0;i < 5;i++)
 944   1                        {
 945   2                          sys_read_vp(0x2003,(u8*)&gCtrlPara.On,1); //ËØªËß¶Êéß
 946   2                        }
 947   1                        if(gCtrlPara.On == 0x005A)      
 948   1                        {
 949   2                          sys_read_vp(0x2003,(u8*)&gCtrlPara.On,1); //ËØªËß¶Êéß
 950   2                          if(gCtrlPara.On == 0x005A)
 951   2                          {
 952   3                            KillTimer(3);
 953   3                            Send_ModBus(0x05,0x0004,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
 954   3                            gCtrlPara.On = 0;
 955   3                            sys_write_vp(0x2003,(u8*)&gCtrlPara.On,1);//Ëß¶ÊéßÊ∏ÖÈõ∂    
 956   3                          }       
 957   2                        }
 958   1                        
 959   1                        //‰∏ã(Á¨¨‰∏ÄÊ¨°)
 960   1                        for(i = 0;i < 5;i++)
 961   1                        {
 962   2                          sys_read_vp(0x2004,(u8*)&gCtrlPara.Under,1);  //ËØªËß¶Êéß
 963   2                        }
 964   1                        if(gCtrlPara.Under == 0x005A)     
 965   1                        {
 966   2                          sys_read_vp(0x2004,(u8*)&gCtrlPara.Under,1);  //ËØªËß¶Êéß
 967   2                          if(gCtrlPara.Under == 0x005A)
 968   2                          {
 969   3                              Send_ModBus(0x05,0x0005,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
 970   3                              gCtrlPara.Under = 0;
 971   3                              sys_write_vp(0x2004,(u8*)&gCtrlPara.Under,1);//Ëß¶ÊéßÊ∏ÖÈõ∂ 
 972   3                            
 973   3                            gCtrlPara.SendFlag = 1; 
 974   3                          }       
 975   2                        }
 976   1                        
 977   1                        //‰∏ãÔºàÊùæÂºÄÔºâ
 978   1                        for(i = 0;i < 5;i++)
 979   1                        {
 980   2                          sys_read_vp(0x2005,(u8*)&gCtrlPara.Under,1);  //ËØªËß¶Êéß
 981   2                        }
 982   1                        if(gCtrlPara.Under == 0x005A)     
 983   1                        {
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 17  

 984   2                          sys_read_vp(0x2005,(u8*)&gCtrlPara.Under,1);  //ËØªËß¶Êéß
 985   2                          if(gCtrlPara.Under == 0x005A)
 986   2                          {
 987   3                              Send_ModBus(0x05,0x0005,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
 988   3                              gCtrlPara.Under = 0;
 989   3                              sys_write_vp(0x2005,(u8*)&gCtrlPara.Under,1);//Ëß¶ÊéßÊ∏ÖÈõ∂                                 
 990   3                          }       
 991   2                        }
 992   1                            
 993   1                        //Â∑¶(Á¨¨‰∏ÄÊ¨°)
 994   1                        for(i = 0;i < 5;i++)
 995   1                        {
 996   2                          sys_read_vp(0x2006,(u8*)&gCtrlPara.Left,1); //ËØªËß¶Êéß
 997   2                        }
 998   1                        if(gCtrlPara.Left == 0x005A)      
 999   1                        {
1000   2                          sys_read_vp(0x2006,(u8*)&gCtrlPara.Left,1); //ËØªËß¶Êéß
1001   2                          if(gCtrlPara.Left == 0x005A)
1002   2                          {
1003   3                              Send_ModBus(0x05,0x0006,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
1004   3                              gCtrlPara.Left = 0;
1005   3                              sys_write_vp(0x2006,(u8*)&gCtrlPara.Left,1);//Ëß¶ÊéßÊ∏ÖÈõ∂    
1006   3                            
1007   3                            gCtrlPara.SendFlag = 1; 
1008   3                          }       
1009   2                        }
1010   1                        
1011   1      
1012   1                        //Â∑¶ÔºàÊùæÂºÄÔºâ
1013   1                        for(i = 0;i < 5;i++)
1014   1                        {
1015   2                          sys_read_vp(0x2007,(u8*)&gCtrlPara.Left,1); //ËØªËß¶Êéß
1016   2                        }
1017   1                        if(gCtrlPara.Left == 0x005A)      
1018   1                        {
1019   2                          sys_read_vp(0x2007,(u8*)&gCtrlPara.Left,1); //ËØªËß¶Êéß
1020   2                          if(gCtrlPara.Left == 0x005A)
1021   2                          {
1022   3                              Send_ModBus(0x05,0x0006,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
1023   3                              gCtrlPara.Left = 0;
1024   3                              sys_write_vp(0x2007,(u8*)&gCtrlPara.Left,1);//Ëß¶ÊéßÊ∏ÖÈõ∂                              
1025   3                          }       
1026   2                        }
1027   1                        
1028   1                        //Âè≥(Á¨¨‰∏ÄÊ¨°)
1029   1                        for(i = 0;i < 5;i++)
1030   1                        {
1031   2                          sys_read_vp(0x2008,(u8*)&gCtrlPara.Right,1);  //ËØªËß¶Êéß
1032   2                        }
1033   1                        if(gCtrlPara.Right == 0x005A)     
1034   1                        {
1035   2                          sys_read_vp(0x2008,(u8*)&gCtrlPara.Right,1);  //ËØªËß¶Êéß
1036   2                          if(gCtrlPara.Right == 0x005A)
1037   2                          {
1038   3                              Send_ModBus(0x05,0x0007,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
1039   3                              gCtrlPara.Right = 0;
1040   3                              sys_write_vp(0x2008,(u8*)&gCtrlPara.Right,1);//Ëß¶ÊéßÊ∏ÖÈõ∂   
1041   3                            
1042   3                            gCtrlPara.SendFlag = 1; 
1043   3                          }       
1044   2                        }
1045   1                        
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 18  

1046   1      
1047   1                        //Âè≥ÔºàÊùæÂºÄÔºâ
1048   1                        for(i = 0;i < 5;i++)
1049   1                        {
1050   2                          sys_read_vp(0x2009,(u8*)&gCtrlPara.Right,1);  //ËØªËß¶Êéß
1051   2                        }
1052   1                        if(gCtrlPara.Right == 0x005A)     
1053   1                        {
1054   2                          sys_read_vp(0x2009,(u8*)&gCtrlPara.Right,1);  //ËØªËß¶Êéß
1055   2                          if(gCtrlPara.Right == 0x005A)
1056   2                          {
1057   3                              Send_ModBus(0x05,0x0007,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
1058   3                              gCtrlPara.Right = 0;
1059   3                              sys_write_vp(0x2009,(u8*)&gCtrlPara.Right,1);//Ëß¶ÊéßÊ∏ÖÈõ∂   
1060   3                          }       
1061   2                        }
1062   1                        
1063   1                        //ZËΩ¥Ê≠£(Á¨¨‰∏ÄÊ¨°)
1064   1                        for(i = 0;i < 5;i++)
1065   1                        {
1066   2                          sys_read_vp(0x200D,(u8*)&gCtrlPara.Z_Positive,1); //ËØªËß¶Êéß
1067   2                        }
1068   1                        if(gCtrlPara.Z_Positive == 0x005A)      
1069   1                        {
1070   2                          sys_read_vp(0x200D,(u8*)&gCtrlPara.Z_Positive,1); //ËØªËß¶Êéß
1071   2                          if(gCtrlPara.Z_Positive == 0x005A)
1072   2                          {
1073   3                              Send_ModBus(0x05,0x0014,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
1074   3                              gCtrlPara.Z_Positive = 0;
1075   3                              sys_write_vp(0x200D,(u8*)&gCtrlPara.Z_Positive,1);//Ëß¶ÊéßÊ∏ÖÈõ∂  
1076   3                            
1077   3                            gCtrlPara.SendFlag = 1; 
1078   3                          }       
1079   2                        }
1080   1      
1081   1                        //ZËΩ¥Ê≠£ÔºàÊùæÂºÄÔºâ
1082   1                        for(i = 0;i < 5;i++)
1083   1                        {
1084   2                          sys_read_vp(0x200E,(u8*)&gCtrlPara.Z_Positive,1); //ËØªËß¶Êéß
1085   2                        }
1086   1                        if(gCtrlPara.Z_Positive == 0x005A)      
1087   1                        {
1088   2                          sys_read_vp(0x200E,(u8*)&gCtrlPara.Z_Positive,1); //ËØªËß¶Êéß
1089   2                          if(gCtrlPara.Z_Positive == 0x005A)
1090   2                          {
1091   3                              Send_ModBus(0x05,0x0014,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
1092   3                              gCtrlPara.Z_Positive = 0;
1093   3                              sys_write_vp(0x200E,(u8*)&gCtrlPara.Z_Positive,1);//Ëß¶ÊéßÊ∏ÖÈõ∂
1094   3                          }       
1095   2                        }
1096   1                        
1097   1                        //ZËΩ¥Ë¥ü(Á¨¨‰∏ÄÊ¨°)
1098   1                        for(i = 0;i < 5;i++)
1099   1                        {
1100   2                          sys_read_vp(0x200F,(u8*)&gCtrlPara.Z_Peverse,1);  //ËØªËß¶Êéß
1101   2                        }
1102   1                        if(gCtrlPara.Z_Peverse == 0x005A)     
1103   1                        {
1104   2                          sys_read_vp(0x200F,(u8*)&gCtrlPara.Z_Peverse,1);  //ËØªËß¶Êéß
1105   2                          if(gCtrlPara.Z_Peverse == 0x005A)
1106   2                          {
1107   3                              Send_ModBus(0x05,0x0015,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 19  

1108   3                              gCtrlPara.Z_Peverse = 0;
1109   3                              sys_write_vp(0x200F,(u8*)&gCtrlPara.Z_Peverse,1);//Ëß¶ÊéßÊ∏ÖÈõ∂
1110   3                            
1111   3                            gCtrlPara.SendFlag = 1; 
1112   3                          }       
1113   2                        }
1114   1      
1115   1                        //ZËΩ¥Ë¥üÔºàÊùæÂºÄÔºâ
1116   1                        for(i = 0;i < 5;i++)
1117   1                        {
1118   2                          sys_read_vp(0x2010,(u8*)&gCtrlPara.Z_Peverse,1);  //ËØªËß¶Êéß
1119   2                        }
1120   1                        if(gCtrlPara.Z_Peverse == 0x005A)     
1121   1                        {
1122   2                          sys_read_vp(0x2010,(u8*)&gCtrlPara.Z_Peverse,1);  //ËØªËß¶Êéß
1123   2                          if(gCtrlPara.Z_Peverse == 0x005A)
1124   2                          {
1125   3                              Send_ModBus(0x05,0x0015,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
1126   3                              gCtrlPara.Z_Peverse = 0;
1127   3                              sys_write_vp(0x2010,(u8*)&gCtrlPara.Z_Peverse,1);//Ëß¶ÊéßÊ∏ÖÈõ∂ 
1128   3                          }       
1129   2                        }
1130   1                        
1131   1                        //UËΩ¥Ê≠£(Á¨¨‰∏ÄÊ¨°)
1132   1                        for(i = 0;i < 5;i++)
1133   1                        {
1134   2                          sys_read_vp(0x2011,(u8*)&gCtrlPara.U_Positive,1); //ËØªËß¶Êéß
1135   2                        }
1136   1                        if(gCtrlPara.U_Positive == 0x005A)      
1137   1                        {
1138   2                          sys_read_vp(0x2011,(u8*)&gCtrlPara.U_Positive,1); //ËØªËß¶Êéß
1139   2                          if(gCtrlPara.U_Positive == 0x005A)
1140   2                          {
1141   3                              Send_ModBus(0x05,0x0016,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
1142   3                              gCtrlPara.U_Positive = 0;
1143   3                              sys_write_vp(0x2011,(u8*)&gCtrlPara.U_Positive,1);//Ëß¶ÊéßÊ∏ÖÈõ∂    
1144   3                            
1145   3                            gCtrlPara.SendFlag = 1; 
1146   3                          }       
1147   2                        }
1148   1      
1149   1                        //UËΩ¥Ê≠£ÔºàÊùæÂºÄÔºâ
1150   1                        for(i = 0;i < 5;i++)
1151   1                        {
1152   2                          sys_read_vp(0x2012,(u8*)&gCtrlPara.U_Positive,1); //ËØªËß¶Êéß
1153   2                        }
1154   1                        if(gCtrlPara.U_Positive == 0x005A)      
1155   1                        {
1156   2      
1157   2                          sys_read_vp(0x2012,(u8*)&gCtrlPara.U_Positive,1); //ËØªËß¶Êéß
1158   2                          if(gCtrlPara.U_Positive == 0x005A)
1159   2                          {
1160   3                              Send_ModBus(0x05,0x0016,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
1161   3                              gCtrlPara.U_Positive = 0;
1162   3                              sys_write_vp(0x2012,(u8*)&gCtrlPara.U_Positive,1);//Ëß¶ÊéßÊ∏ÖÈõ∂    
1163   3                            
1164   3                          }       
1165   2                        }
1166   1                        
1167   1                        //UËΩ¥Ë¥ü(Á¨¨‰∏ÄÊ¨°)
1168   1                        for(i = 0;i < 5;i++)
1169   1                        {
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 20  

1170   2                          sys_read_vp(0x2013,(u8*)&gCtrlPara.U_Peverse,1);  //ËØªËß¶Êéß
1171   2                        }
1172   1                        if(gCtrlPara.U_Peverse == 0x005A)     
1173   1                        {
1174   2                          sys_read_vp(0x2013,(u8*)&gCtrlPara.U_Peverse,1);  //ËØªËß¶Êéß
1175   2                          if(gCtrlPara.U_Peverse == 0x005A)
1176   2                          {
1177   3                              Send_ModBus(0x05,0x0017,0xFF00,0x00);//‰∏ãÂèëËß¶Êéß
1178   3                              gCtrlPara.U_Peverse = 0;
1179   3                              sys_write_vp(0x2013,(u8*)&gCtrlPara.U_Peverse,1);//Ëß¶ÊéßÊ∏ÖÈõ∂   
1180   3                            
1181   3                            gCtrlPara.SendFlag = 1; 
1182   3                          }       
1183   2                        }
1184   1      
1185   1                        //UËΩ¥Ë¥üÔºàÊùæÂºÄÔºâ
1186   1                        for(i = 0;i < 5;i++)
1187   1                        {
1188   2                          sys_read_vp(0x2014,(u8*)&gCtrlPara.U_Peverse,1);  //ËØªËß¶Êéß
1189   2                        }
1190   1                        if(gCtrlPara.U_Peverse == 0x005A)     
1191   1                        {
1192   2                          sys_read_vp(0x2014,(u8*)&gCtrlPara.U_Peverse,1);  //ËØªËß¶Êéß
1193   2                          if(gCtrlPara.U_Peverse == 0x005A)
1194   2                          {
1195   3                              Send_ModBus(0x05,0x0017,0x0000,0x00);//‰∏ãÂèëËß¶Êéß
1196   3                              gCtrlPara.U_Peverse = 0;
1197   3                              sys_write_vp(0x2014,(u8*)&gCtrlPara.U_Peverse,1);//Ëß¶ÊéßÊ∏ÖÈõ∂   
1198   3                          }       
1199   2                        }
1200   1      }
1201          void Touch_Scan_10_12(void)
1202          {
1203   1        
1204   1        u8 i;
1205   1                        for(i = 0;i < 5;i++)
1206   1                        {
1207   2                          sys_read_vp(0x10B1,(u8*)&gCtrlPara.Icon_Init,1);  //ËØªËß¶Êéß
1208   2                        }
1209   1                        if(gCtrlPara.Icon_Init != gCtrlPara.Icon_InitHis)     
1210   1                        {
1211   2                          sys_read_vp(0x10B1,(u8*)&gCtrlPara.Icon_Init,1);  //ËØªËß¶Êéß
1212   2                          if(gCtrlPara.Icon_Init != gCtrlPara.Icon_InitHis) 
1213   2                          {
1214   3                            
1215   3                            if(gCtrlPara.Icon_Init == 1)
1216   3                            {
1217   4                                HOST_Addr = 0x0051;
1218   4                                Send_ModBus_10(0x10,0x0051,0x01,gCtrlPara.Icon_Init,0x2);
1219   4                                delay_ms(5);
1220   4                                Send_ModBus(0x03,0x0051,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
1221   4              
1222   4                            }
1223   3                            else if(gCtrlPara.Icon_Init == 2)
1224   3                            {
1225   4                                HOST_Addr = 0x0052;
1226   4                                Send_ModBus_10(0x10,0x0052,0x01,gCtrlPara.Icon_Init,0x2);
1227   4                              
1228   4                                delay_ms(5);
1229   4                                Send_ModBus(0x03,0x0052,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
1230   4                            }
1231   3                            else if(gCtrlPara.Icon_Init == 3)
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 21  

1232   3                            {
1233   4                                HOST_Addr = 0x0053;
1234   4                                Send_ModBus_10(0x10,0x0053,0x01,gCtrlPara.Icon_Init,0x2);
1235   4                              
1236   4                                delay_ms(5);
1237   4                                Send_ModBus(0x03,0x0053,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
1238   4                            }
1239   3                            else if(gCtrlPara.Icon_Init == 4)
1240   3                            {
1241   4                                HOST_Addr = 0x0054;
1242   4                                Send_ModBus_10(0x10,0x0054,0x01,gCtrlPara.Icon_Init,0x2);
1243   4                              
1244   4                                delay_ms(5);
1245   4                                Send_ModBus(0x03,0x0054,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
1246   4                            }
1247   3                            else if(gCtrlPara.Icon_Init == 5)
1248   3                            {
1249   4                                HOST_Addr = 0x0055;
1250   4                                Send_ModBus_10(0x10,0x0055,0x01,gCtrlPara.Icon_Init,0x2);
1251   4                              
1252   4                                delay_ms(5);
1253   4                                Send_ModBus(0x03,0x0055,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
1254   4                            }
1255   3                            else if(gCtrlPara.Icon_Init == 6)
1256   3                            {
1257   4                                HOST_Addr = 0x0056;
1258   4                                Send_ModBus_10(0x10,0x0056,0x01,gCtrlPara.Icon_Init,0x2);
1259   4                              
1260   4                                delay_ms(5);
1261   4                                Send_ModBus(0x03,0x0056,0x0000,0x01);//‰∏ãÂèëËß¶Êéß 
1262   4                            }
1263   3                            
1264   3                          sys_write_vp(0x10B1,(u8*)&gCtrlPara.Icon_InitHis,1);//Ëß¶ÊéßÊ∏ÖÈõ∂      
1265   3                          }
1266   2                        }
1267   1      }
1268          
1269          //void Touch_Scan_10_12(void)
1270          //{
1271          //  u8 i;
1272                      //ËØ≠Ë®Ä
1273          //            for(i = 0;i < 10;i++)
1274          //            {
1275          //              sys_read_vp(HMI_Read_Language_Enter,(u8*)&gCtrlPara.Language_Enter,1);  //ËØªËß¶Êéß
1276          //            }
1277          //            if(gCtrlPara.Language_Enter == 0x01)      
1278          //            {
1279          //              sys_read_vp(HMI_Read_Language_Enter,(u8*)&gCtrlPara.Language_Enter,1);  //ËØªËß¶Êéß
1280          //              if(gCtrlPara.Language_Enter == 0x01)
1281          //              {
1282          //                sys_read_vp(HMI_Read_Language,(u8*)&gCtrlPara.Language,1);  
1283          //                Write_Nor_Flash();
1284          //                sys_delay_ms(1);
1285          //                if(gCtrlPara.Language == 0)
1286          //                  Change_Page(0x06);
1287          //                else
1288          //                  Change_Page(0x1F);
1289          //                sys_write_vp(HMI_Read_Language,(u8*)&gCtrlPara.Language,1);
1290          //                
1291          //                gCtrlPara.Language_Enter = 0;
1292          //                sys_write_vp(HMI_Read_Language_Enter,(u8*)&gCtrlPara.Language_Enter,1);//Ëß¶ÊéßÊ∏ÖÈõ∂   
1293          //              }
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 22  

1294          //            }
1295          //}
1296          void Touch_Scan_13(void)
1297          { 
1298   1        u8 i;
1299   1                          if(gCtrlPara.LED_NOWFlag == 1)
1300   1                          {
1301   2                              for(i = 0;i < 5;i++)
1302   2                              {
1303   3                                sys_read_vp(LED_NOW,(u8*)&gCtrlPara.Value,1); //ËØªÂèñÂΩìÂâç‰∫ÆÂ∫¶
1304   3                              }
1305   2                              gCtrlPara.Value = gCtrlPara.Value&0x00FF;
1306   2                              
1307   2                              if((gCtrlPara.Value>0) && (gCtrlPara.Value<= 0x14))
1308   2                              {
1309   3                                  gCtrlPara.Data = 0x0001;                        
1310   3                                  sys_write_vp(0x10A8,(u8*)&gCtrlPara.Data,1);
1311   3                              }
1312   2                              else if((gCtrlPara.Value>0x14) && (gCtrlPara.Value<= 0x32))
1313   2                              {
1314   3                                  gCtrlPara.Data = 0x0002;                        
1315   3                                  sys_write_vp(0x10A8,(u8*)&gCtrlPara.Data,1);
1316   3                              }
1317   2                              else if((gCtrlPara.Value>0x32) && (gCtrlPara.Value<= 0x64))
1318   2                              {
1319   3                                  gCtrlPara.Data = 0x0003;                        
1320   3                                  sys_write_vp(0x10A8,(u8*)&gCtrlPara.Data,1);
1321   3                              }
1322   2                              
1323   2                              gCtrlPara.LED_NOWFlag = 0;
1324   2                          }
1325   1            
1326   1                          for(i = 0;i < 5;i++)
1327   1                          {
1328   2                            sys_read_vp(0x20E0,(u8*)&gCtrlPara.Value,1);  //ËØªËß¶Êéß
1329   2                          }
1330   1                          if(gCtrlPara.Value == 0x0001)     
1331   1                          {
1332   2                            sys_read_vp(0x20E0,(u8*)&gCtrlPara.Value,1);  //ËØªËß¶Êéß
1333   2                            if(gCtrlPara.Value == 0x0001)
1334   2                            {
1335   3      
1336   3                              sys_read_vp(0x10A7,(u8*)&gCtrlPara.Data,1); //ËØªËß¶Êéß
1337   3                              if(gCtrlPara.Data == 0)
1338   3                              {
1339   4                                  sys_write_vp(0x3302,(u8*)&gCtrlPara.Data,1);
1340   4                              }
1341   3                              else if(gCtrlPara.Data == 1)
1342   3                              {
1343   4                                  sys_write_vp(0x3302,(u8*)&gCtrlPara.Data,1);
1344   4                              }
1345   3                                                    
1346   3                              sys_read_vp(0x10A8,(u8*)&gCtrlPara.Data,1); //ËØªËß¶Êéß
1347   3                              if(gCtrlPara.Data == 0x01)
1348   3                              {
1349   4                                  gCtrlPara.Data = 0x1414;
1350   4                                  sys_write_vp(LED_CONFIG,(u8*)&gCtrlPara.Data,1);
1351   4      
1352   4                              }
1353   3                              else if(gCtrlPara.Data == 2)
1354   3                              {
1355   4                                  gCtrlPara.Data = 0x3232;
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 23  

1356   4                                  sys_write_vp(LED_CONFIG,(u8*)&gCtrlPara.Data,1);
1357   4      
1358   4                              }
1359   3                              else if(gCtrlPara.Data == 3)
1360   3                              {
1361   4                                  gCtrlPara.Data = 0x6464;
1362   4                                  sys_write_vp(LED_CONFIG,(u8*)&gCtrlPara.Data,1);
1363   4      
1364   4                              }
1365   3                              
1366   3                                gCtrlPara.Value = 0;
1367   3                                sys_write_vp(0x20E0,(u8*)&gCtrlPara.Value,1);//Ëß¶ÊéßÊ∏ÖÈõ∂                                 
1368   3                            }       
1369   2                          }
1370   1                          
1371   1      }
1372          
1373          void Touch_Scan_14(void)
1374          {
1375   1            u8 i;
1376   1                      //ÂÜôIP
1377   1                      for(i = 0;i < 5;i++)
1378   1                      {
1379   2                        sys_read_vp(HMI_Write_WIFI_IP,(u8*)&gCtrlPara.Write_IP,1);  //ËØªËß¶Êéß
1380   2                      }
1381   1                      if(gCtrlPara.Write_IP == 0x0001)      
1382   1                      {                       
1383   2                        sys_read_vp(HMI_Write_WIFI_IP,(u8*)&gCtrlPara.Write_IP,1);  //ËØªËß¶Êéß
1384   2                        if(gCtrlPara.Write_IP == 0x0001)
1385   2                        {                       
1386   3                            Send_ModBus_IP();//ÂèëÈÄÅIPÂú∞ÂùÄ
1387   3                            delay_ms(1);
1388   3                            gCtrlPara.Write_IP = 0;
1389   3                            sys_write_vp(HMI_Write_WIFI_IP,(u8*)&gCtrlPara.Write_IP,1);//Ëß¶ÊéßÊ∏ÖÈõ∂   
1390   3                        }       
1391   2                      }
1392   1      }
1393          
1394          
1395          void Touch_Scan_16(void)
1396          {
1397   1            u8 i;
1398   1              //ÂØÜÁ†ÅËæìÂÖ•
1399   1              for(i = 0;i < 5;i++)
1400   1              {
1401   2                sys_read_vp(0x401F,(u8*)&gCtrlPara.Value,1);  //ËØªËß¶Êéß
1402   2              }
1403   1              if(gCtrlPara.Value == 0x0001)     
1404   1              {
1405   2                sys_read_vp(0x401F,(u8*)&gCtrlPara.Value,1);  //ËØªËß¶Êéß
1406   2                if(gCtrlPara.Value == 0x0001)
1407   2                {   
1408   3                  sys_read_vp(0x4020,(u8*)&gCtrlPara.Data,1); //ËØªËß¶Êéß
1409   3                  sys_read_vp(0x4021,(u8*)&gCtrlPara.Data1,1);  //ËØªËß¶Êéß
1410   3                  sys_read_vp(0x4022,(u8*)&gCtrlPara.Data2,1);  //ËØªËß¶Êéß
1411   3                  sys_read_vp(0x4023,(u8*)&gCtrlPara.Data3,1);  //ËØªËß¶Êéß
1412   3                  
1413   3                  if((gCtrlPara.Data == 1)&&(gCtrlPara.Data1 == 2)&&(gCtrlPara.Data2 == 3)&&(gCtrlPara.Data3 == 3))
1414   3                  {
1415   4                      Page_Change(0x011);
1416   4                  }
1417   3                }
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 24  

1418   2              }
1419   1      }
1420          //void Touch_Scan_18(void)
1421          //{
1422          //      u8 i;
1423          //  
1424          //            for(i = 0;i < 10;i++)
1425          //            {
1426          //              sys_read_vp(HMI_Keyboard_lock,(u8*)&gCtrlPara.Keyboard_lock,1); //ËØªËß¶Êéß
1427          //            }
1428          //            if(gCtrlPara.Keyboard_lock == 0x01)     
1429          //            {
1430          //              sys_read_vp(HMI_Keyboard_lock,(u8*)&gCtrlPara.Keyboard_lock,1); //ËØªËß¶Êéß
1431          //              if(gCtrlPara.Keyboard_lock == 0x01)
1432          //              {
1433          //                sys_read_vp(HMI_Lock_pas_Addr1,(u8*)&gCtrlPara.Lock_password1,1);
1434          //                sys_read_vp(HMI_Lock_pas_Addr2,(u8*)&gCtrlPara.Lock_password2,1);
1435          //                sys_read_vp(HMI_Lock_pas_Addr3,(u8*)&gCtrlPara.Lock_password3,1);
1436          //                sys_read_vp(HMI_Lock_pas_Addr4,(u8*)&gCtrlPara.Lock_password4,1);
1437          
1438          //                Send_ModBus08_10(0x10,0x0417,0x04,gCtrlPara.Lock_password1,gCtrlPara.Lock_password2,gCtrlPara.Lo
             -ck_password3,gCtrlPara.Lock_password4,0x08);//‰∏ãÂèëÊó∂
1439          //                
1440          //                gCtrlPara.Keyboard_lock = 0;
1441          //                sys_write_vp(HMI_Keyboard_lock,(u8*)&gCtrlPara.Keyboard_lock,1);//Ëß¶ÊéßÊ∏ÖÈõ∂    
1442          //                
1443          //              }       
1444          //            }
1445          //}
1446          
1447          //ÂùêÊ†áÊéßÂà∂ÔºàÊñá‰ª∂Á°ÆËÆ§ÂíåÂà†Èô§Ôºâ
1448          void Coordinate_Control(void)
1449          {
1450   1            sys_read_vp(TP_STATUS,TP_Status_New,4); //ËØªËß¶Êéß
1451   1            Read_StatusFlag=strcmp(TP_Status_New,TP_Status_Old);
1452   1            if(Read_StatusFlag)
1453   1            {     
1454   2              if(TP_Status_New[1] == 0x02)//Êä¨Ëµ∑
1455   2              {
1456   3                  gCtrlPara.Value_X = (TP_Status_New[2]<<8) + TP_Status_New[3];
1457   3                  gCtrlPara.Value_Y = (TP_Status_New[4]<<8) + TP_Status_New[5];
1458   3                  
1459   3                  
1460   3                  if((gCtrlPara.Value_X<=530)&&(gCtrlPara.Value_X>=460))//Âà†Èô§X(460-530)
1461   3                  {
1462   4                        // Y(210-320)110
1463   4                        if((gCtrlPara.Value_Y >= 210)&&(gCtrlPara.Value_Y <= 320) && (gCtrlPara.File_IconNum == 1))
1464   4                        {
1465   5                          HOST_Addr = HMI_Delete;
1466   5                          Send_ModBus_10(0x10,HOST_DeleteR,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1467   5      
1468   5                          delay_ms(5);
1469   5                          gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
1470   5              
1471   5                        }
1472   4      
1473   4                        else if((gCtrlPara.Value_Y >= 330)&&(gCtrlPara.Value_Y <= 440) && (gCtrlPara.File_IconNum == 2))
1474   4                        {
1475   5                          HOST_Addr = HMI_Delete;
1476   5                          Send_ModBus_10(0x10,HOST_DeleteR,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1477   5      
1478   5                          delay_ms(5);
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 25  

1479   5                          gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
1480   5                        }
1481   4                        else if((gCtrlPara.Value_Y >= 450)&&(gCtrlPara.Value_Y <= 550) && (gCtrlPara.File_IconNum == 3))
1482   4                        {
1483   5                          HOST_Addr = HMI_Delete;
1484   5                          Send_ModBus_10(0x10,HOST_DeleteR,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1485   5                          
1486   5                          delay_ms(5);
1487   5                          gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
1488   5                        }
1489   4                        else if((gCtrlPara.Value_Y >= 570)&&(gCtrlPara.Value_Y <= 680) && (gCtrlPara.File_IconNum == 4))
1490   4                        {
1491   5                          HOST_Addr = HMI_Delete;
1492   5                          Send_ModBus_10(0x10,HOST_DeleteR,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1493   5      
1494   5                          delay_ms(5);
1495   5                          gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
1496   5                        }
1497   4                        else if((gCtrlPara.Value_Y >= 685)&&(gCtrlPara.Value_Y <= 790) && (gCtrlPara.File_IconNum == 5))
1498   4                        {
1499   5                          HOST_Addr = HMI_Delete;
1500   5                          Send_ModBus_10(0x10,HOST_DeleteR,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1501   5      
1502   5                          delay_ms(5);
1503   5                          gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
1504   5                        }
1505   4                        else if((gCtrlPara.Value_Y >= 800)&&(gCtrlPara.Value_Y <= 910) && (gCtrlPara.File_IconNum == 6))
1506   4                        {
1507   5                          HOST_Addr = HMI_Delete;
1508   5                          Send_ModBus_10(0x10,HOST_DeleteR,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1509   5      
1510   5                          delay_ms(5);
1511   5                          gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
1512   5                        }
1513   4                        else if((gCtrlPara.Value_Y >= 920)&&(gCtrlPara.Value_Y <= 1030) && (gCtrlPara.File_IconNum == 7))
1514   4                        {
1515   5                          HOST_Addr = HMI_Delete;
1516   5                          Send_ModBus_10(0x10,HOST_DeleteR,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1517   5      
1518   5                          delay_ms(5);
1519   5                          gCtrlPara.FileFlag = 0;//ËØªÊñá‰ª∂Ê†áÂøó
1520   5                        }
1521   4                    
1522   4                  }
1523   3                  else  if((gCtrlPara.Value_X<=680)&&(gCtrlPara.Value_X>570))//X(570-680)Á°ÆËÆ§
1524   3                  {
1525   4                        // Y(130-195)
1526   4                        if((gCtrlPara.Value_Y >= 210)&&(gCtrlPara.Value_Y <= 320) && (gCtrlPara.File_IconNum == 1))
1527   4                        {
1528   5                          HOST_Addr = HMI_Confirm;
1529   5                          Send_ModBus_10(0x10,HOST_Confirm,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1530   5                          UART4_Sendbyte(0x01);
1531   5                          Page_Change(0x01);
1532   5                        }
1533   4                        // Y(205-270)
1534   4                        else if((gCtrlPara.Value_Y >= 330)&&(gCtrlPara.Value_Y <= 440) && (gCtrlPara.File_IconNum == 2))
1535   4                        {
1536   5                          HOST_Addr = HMI_Confirm;
1537   5                          Send_ModBus_10(0x10,HOST_Confirm,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1538   5                          
1539   5                          UART4_Sendbyte(0x02);
1540   5                          Page_Change(0x01);
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 26  

1541   5                        }
1542   4                        else if((gCtrlPara.Value_Y >= 450)&&(gCtrlPara.Value_Y <= 550) && (gCtrlPara.File_IconNum == 3))
1543   4                        {
1544   5                          HOST_Addr = HMI_Confirm;
1545   5                          Send_ModBus_10(0x10,HOST_Confirm,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1546   5                          UART4_Sendbyte(0x03);
1547   5                          Page_Change(0x01);
1548   5                        }
1549   4                        else if((gCtrlPara.Value_Y >= 570)&&(gCtrlPara.Value_Y <= 680) && (gCtrlPara.File_IconNum == 4))
1550   4                        {
1551   5                          HOST_Addr = HMI_Confirm;
1552   5                          Send_ModBus_10(0x10,HOST_Confirm,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1553   5                          UART4_Sendbyte(0x01);
1554   5                          Page_Change(0x01);
1555   5                        }
1556   4                        else if((gCtrlPara.Value_Y >= 685)&&(gCtrlPara.Value_Y <= 790) && (gCtrlPara.File_IconNum == 5))
1557   4                        {
1558   5                          HOST_Addr = HMI_Confirm;
1559   5                          Send_ModBus_10(0x10,HOST_Confirm,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1560   5                          UART4_Sendbyte(0x01);
1561   5                          Page_Change(0x01);
1562   5                        }
1563   4                        else if((gCtrlPara.Value_Y >= 800)&&(gCtrlPara.Value_Y <= 910) && (gCtrlPara.File_IconNum == 6))
1564   4                        {
1565   5                          HOST_Addr = HMI_Confirm;
1566   5                          Send_ModBus_10(0x10,HOST_Confirm,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1567   5                          UART4_Sendbyte(0x01);
1568   5                          Page_Change(0x01);
1569   5                        }
1570   4                        else if((gCtrlPara.Value_Y >= 920)&&(gCtrlPara.Value_Y <= 1030) && (gCtrlPara.File_IconNum == 7))
1571   4                        {
1572   5                          HOST_Addr = HMI_Confirm;
1573   5                          Send_ModBus_10(0x10,HOST_Confirm,0x1,gCtrlPara.File_Num,0x2);//‰∏ãÂèëÊñá‰ª∂Âè∑  
1574   5                          UART4_Sendbyte(0x01);
1575   5                          Page_Change(0x01);
1576   5                        }
1577   4                  }
1578   3      
1579   3                    
1580   3                  
1581   3      //          for( i=0;i<9;i++)
1582   3      //          {
1583   3      //            UART4_Sendbyte(TP_Status_New[i]);
1584   3      //          }
1585   3              
1586   3              }
1587   2                memcpy(TP_Status_Old,TP_Status_New,sizeof(TP_Status_New));//
1588   2            }
1589   1            else
1590   1            {
1591   2      
1592   2            }
1593   1          
1594   1      
1595   1      }
1596          
1597          //ÂÜÖÂ≠òÊéßÂà∂
1598          void File_Control(void)
1599          {
1600   1              u8 i;
1601   1        
1602   1              
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 27  

1603   1              if(gCtrlPara.Memory == 0x0001)//ÂÜÖÂ≠ò
1604   1              {
1605   2      
1606   2                         if((gCtrlPara.FileFlag == 0) || (gCtrlPara.FileFlag == 1) || (gCtrlPara.Current_Control !=
             - gCtrlPara.Current_ControlHis))
1607   2                         {      
1608   3      //                      gTime6++;
1609   3      //                      if(gTime6 > 10)
1610   3      //                      { 
1611   3      //                        gTime6 = 0;                               
1612   3      
1613   3                                if(gCtrlPara.FileCount == 0)
1614   3                                {                                           
1615   4                                  //Êñá‰ª∂ÊÄªÊï∞
1616   4                                   HOST_Addr = HMI_Total_Files;
1617   4                                   Send_ModBus(0x03,HOST_Total_Files,0x0000,0x01);                          
1618   4                                }
1619   3      
1620   3                                if(gCtrlPara.Total_Files > 0)//ÊúâÊñá‰ª∂
1621   3                                {
1622   4                                    if((gCtrlPara.Current_Control >= 1) && (gCtrlPara.Current_Control <= gCtrlPara.Integer))
1623   4                                    {
1624   5                                          switch(gCtrlPara.FileCount)
1625   5                                          {
1626   6                                            case 1:
1627   6                                            {
1628   7                                                //‰∏ÄÂè∑Êñá‰ª∂
1629   7                                               gCtrlPara.Number++;
1630   7                                               HOST_Addr = HMI_NowFile1;
1631   7                                               Send_ModBus(0x03,HOST_NowFile1+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1632   7                                              gTime9++;
1633   7                                              if(gTime9 >= 1)
1634   7                                              {
1635   8                                                  gTime9 = 0;
1636   8                                                  gCtrlPara.FileCount = 2;
1637   8                                              }
1638   7                                            }
1639   6                                            break;
1640   6                                            case 2:
1641   6                                            {
1642   7                                              //‰∫åÂè∑Êñá‰ª∂
1643   7                                              gCtrlPara.Number++;
1644   7                                              HOST_Addr = HMI_NowFile2;
1645   7                                              Send_ModBus(0x03,HOST_NowFile2+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1646   7                                              gTime9++;
1647   7                                              if(gTime9 >= 1)
1648   7                                              {
1649   8                                                  gTime9 = 0;
1650   8                                                  gCtrlPara.FileCount = 3;
1651   8                                              }
1652   7                                            }
1653   6                                            break;
1654   6                    
1655   6                                            case 3:
1656   6                                            {
1657   7                                              //‰∏âÂè∑Êñá‰ª∂
1658   7                                              gCtrlPara.Number++;
1659   7                                               HOST_Addr = HMI_NowFile3;
1660   7                                               Send_ModBus(0x03,HOST_NowFile3+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1661   7                                              gTime9++;
1662   7                                              if(gTime9 >= 1)
1663   7                                              {
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 28  

1664   8                                                  gTime9 = 0;
1665   8                                                  gCtrlPara.FileCount = 4;
1666   8                                              }
1667   7                                            }
1668   6                                            break;
1669   6                                            case 4:
1670   6                                            {
1671   7                                              //ÂõõÂè∑Êñá‰ª∂
1672   7                                              gCtrlPara.Number++;
1673   7                                               HOST_Addr = HMI_NowFile4;
1674   7                                               Send_ModBus(0x03,HOST_NowFile4+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1675   7                                              gTime9++;
1676   7                                              if(gTime9 >= 1)
1677   7                                              {
1678   8                                                  gTime9 = 0;
1679   8                                                  gCtrlPara.FileCount = 5;
1680   8                                              }
1681   7                                            }
1682   6                                            break;
1683   6                                            case 5:
1684   6                                            {
1685   7                                              //‰∫îÂè∑Êñá‰ª∂
1686   7                                              gCtrlPara.Number++;
1687   7                                               HOST_Addr = HMI_NowFile5;
1688   7                                               Send_ModBus(0x03,HOST_NowFile5+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1689   7                                              gTime9++;
1690   7                                              if(gTime9 >= 1)
1691   7                                              {
1692   8                                                  gTime9 = 0;
1693   8                                                  gCtrlPara.FileCount = 6;
1694   8                                              }
1695   7                                            }
1696   6                                            break;
1697   6                                            case 6:
1698   6                                            {
1699   7                                              //ÂÖ≠Âè∑Êñá‰ª∂
1700   7                                              gCtrlPara.Number++;
1701   7                                               HOST_Addr = HMI_NowFile6;
1702   7                                               Send_ModBus(0x03,HOST_NowFile6+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1703   7                                              gTime9++;
1704   7                                              if(gTime9 >= 1)
1705   7                                              {
1706   8                                                  gTime9 = 0;
1707   8                                                  gCtrlPara.FileCount = 7;
1708   8                                              }
1709   7                                            }
1710   6                                            break;
1711   6                                            case 7:
1712   6                                            {
1713   7                                              //‰∏ÉÂè∑Êñá‰ª∂
1714   7                                              gCtrlPara.Number++;
1715   7                                               HOST_Addr = HMI_NowFile7;
1716   7                                               Send_ModBus(0x03,HOST_NowFile7+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1717   7                                              gTime9++;
1718   7                                              if(gTime9 >= 1)
1719   7                                              {
1720   8                                                  gTime9 = 0;
1721   8                                                  gCtrlPara.FileCount = 8;
1722   8                                              }
1723   7                                            }
1724   6                                            break;
1725   6                                            case 8:
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 29  

1726   6                                            {
1727   7                                                gCtrlPara.Current_ControlHis = gCtrlPara.Current_Control;   
1728   7                                    
1729   7                                                gCtrlPara.FileFlag++;
1730   7                                                if(gCtrlPara.FileFlag > 1)
1731   7                                                {
1732   8                                                  gCtrlPara.FileFlag = 2;
1733   8      //                                            gCtrlPara.Total_FilesHis = gCtrlPara.Total_Files;
1734   8                                                }
1735   7                                                
1736   7                                                gCtrlPara.Number = 0;   
1737   7                                                gCtrlPara.NumberHis = 0;
1738   7                                              
1739   7                                                gCtrlPara.FileCount = 0;
1740   7                                            }
1741   6                                            break;
1742   6                                          }
1743   5                                    }
1744   4                                    else if((gCtrlPara.Integer == 0) || ((gCtrlPara.Current_Control >= 1)&&(gCtrlPara.Current_C
             -ontrol == (gCtrlPara.Integer+1))))
1745   4                                    {
1746   5                                          if(gCtrlPara.FileCount > gCtrlPara.Remainder)//Ê≠•ËøõÂÄºÂ§ß‰∫é‰ΩôÊï∞Ë∑≥Âá∫
1747   5                                          {
1748   6                                            gCtrlPara.Current_ControlHis = gCtrlPara.Current_Control;   
1749   6                                    
1750   6                                            gCtrlPara.FileFlag++;
1751   6                                            if(gCtrlPara.FileFlag > 1)
1752   6                                            {
1753   7                                              gCtrlPara.FileFlag = 2;
1754   7      //                                        gCtrlPara.Total_FilesHis = gCtrlPara.Total_Files;
1755   7                                            }
1756   6                                            
1757   6                                            gCtrlPara.Number = 0;   
1758   6                                            gCtrlPara.NumberHis = 0;
1759   6                                            
1760   6                                            
1761   6                                            gCtrlPara.FileCount = 0;
1762   6                                          }
1763   5                                          
1764   5                                          switch(gCtrlPara.FileCount)
1765   5                                          { 
1766   6                                            case 1:
1767   6                                            {
1768   7                                              //‰∏ÄÂè∑Êñá‰ª∂
1769   7                                               gCtrlPara.Number++;
1770   7                                               HOST_Addr = HMI_NowFile1;
1771   7                                               Send_ModBus(0x03,HOST_NowFile1+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1772   7                                                gTime9++;
1773   7                                              if(gTime9 >= 1)
1774   7                                              {
1775   8                                                  gTime9 = 0;
1776   8                                                  gCtrlPara.FileCount = 2;
1777   8                                              }
1778   7                                            }
1779   6                                            break;
1780   6                                            case 2:
1781   6                                            {
1782   7                                              //‰∫åÂè∑Êñá‰ª∂
1783   7                                               gCtrlPara.Number++;
1784   7                                               HOST_Addr = HMI_NowFile2;
1785   7                                               Send_ModBus(0x03,HOST_NowFile2+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1786   7                                              gTime9++;
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 30  

1787   7                                              if(gTime9 >= 1)
1788   7                                              {
1789   8                                                  gTime9 = 0;
1790   8                                                  gCtrlPara.FileCount = 3;
1791   8                                              }
1792   7                                            }
1793   6                                            break;
1794   6                                            case 3:
1795   6                                            {
1796   7                                              //‰∏âÂè∑Êñá‰ª∂
1797   7                                               gCtrlPara.Number++;
1798   7                                               HOST_Addr = HMI_NowFile3;
1799   7                                               Send_ModBus(0x03,HOST_NowFile3+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1800   7                                              gTime9++;
1801   7                                              if(gTime9 >= 1)
1802   7                                              {
1803   8                                                  gTime9 = 0;
1804   8                                                  gCtrlPara.FileCount = 4;
1805   8                                              }
1806   7                                            }
1807   6                                            break;
1808   6                                            case 4:
1809   6                                            {
1810   7                                              //ÂõõÂè∑Êñá‰ª∂
1811   7                                               gCtrlPara.Number++;
1812   7                                               HOST_Addr = HMI_NowFile4;
1813   7                                               Send_ModBus(0x03,HOST_NowFile4+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1814   7                                              gTime9++;
1815   7                                              if(gTime9 >= 1)
1816   7                                              {
1817   8                                                  gTime9 = 0;
1818   8                                                  gCtrlPara.FileCount = 5;
1819   8                                              }
1820   7                                            }
1821   6                                            break;                        
1822   6                                            case 5:
1823   6                                            {
1824   7                                              //‰∫îÂè∑Êñá‰ª∂
1825   7                                              gCtrlPara.Number++;
1826   7                                               HOST_Addr = HMI_NowFile5;
1827   7                                               Send_ModBus(0x03,HOST_NowFile5+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1828   7                                              gTime9++;
1829   7                                              if(gTime9 >= 1)
1830   7                                              {
1831   8                                                  gTime9 = 0;
1832   8                                                  gCtrlPara.FileCount = 6;
1833   8                                              }
1834   7                                            }
1835   6                                            break;
1836   6                                            case 6:
1837   6                                            {
1838   7                                              //ÂÖ≠Âè∑Êñá‰ª∂
1839   7                                              gCtrlPara.Number++;
1840   7                                               HOST_Addr = HMI_NowFile6;
1841   7                                               Send_ModBus(0x03,HOST_NowFile6+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1842   7                                              gTime9++;
1843   7                                              if(gTime9 >= 1)
1844   7                                              {
1845   8                                                  gTime9 = 0;
1846   8                                                  gCtrlPara.FileCount = 7;
1847   8                                              }
1848   7                                            }
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 31  

1849   6                                            break;
1850   6                                            case 7:
1851   6                                            {
1852   7                                              //‰∏ÉÂè∑Êñá‰ª∂
1853   7                                              gCtrlPara.Number++;
1854   7                                               HOST_Addr = HMI_NowFile7;
1855   7                                               Send_ModBus(0x03,HOST_NowFile7+gCtrlPara.Number_Control*4*7,0x0000,0x04);
1856   7                                              gTime9++;
1857   7                                              if(gTime9 >= 1)
1858   7                                              {
1859   8                                                  gTime9 = 0;
1860   8                                                  gCtrlPara.FileCount = 8;
1861   8                                              }
1862   7                                            }
1863   6                                            break;
1864   6                                          }                                                                                                                 
1865   5                                  }
1866   4                                  
1867   4                                  if(gCtrlPara.FileFlag == 0)
1868   4                                  {
1869   5                                        if(gCtrlPara.NumberHis != gCtrlPara.Number)//ÊúâÊñá‰ª∂
1870   5                                        {
1871   6                                            for(i = 0;i<gCtrlPara.Number;i++)
1872   6                                            {
1873   7                                                gCtrlPara.File_Control = 0;//Êñá‰ª∂ÊéßÂà∂
1874   7                                                sys_write_vp(HMI_File_Control+i,(u8*)&gCtrlPara.File_Control,1);
1875   7                                              
1876   7                                                sys_write_vp(HMI_File_Icon + i,(u8*)&gCtrlPara.File_IconHis,1);//Êñá‰ª∂ÂõæÊ†áËß¶ÊéßÊ∏
             -ÖÈõ∂                                                                                    
1877   7                                            }
1878   6                                            for(i = 6;i>=gCtrlPara.Number;i--)
1879   6                                            { 
1880   7                                                gCtrlPara.File_Control = 1;//Êñá‰ª∂ÊéßÂà∂
1881   7                                                sys_write_vp(HMI_File_Control+i,(u8*)&gCtrlPara.File_Control,1);
1882   7                                            }
1883   6                                            gCtrlPara.NumberHis = gCtrlPara.Number;
1884   6                                        }
1885   5                                  }
1886   4                        }
1887   3                        else
1888   3                        {     
1889   4                                if(gCtrlPara.FileCount == 1)
1890   4                                {
1891   5                                    //Ê≤°ÊúâÊñá‰ª∂
1892   5                                    for(i=0;i<7;i++)
1893   5                                    {
1894   6                                        gCtrlPara.File_Control = 1;//Êñá‰ª∂ÊéßÂà∂
1895   6                                        sys_write_vp(HMI_File_Control + i,(u8*)&gCtrlPara.File_Control,1);
1896   6                                      
1897   6                                        sys_write_vp(HMI_File_Icon + i,(u8*)&gCtrlPara.File_IconHis,1);//Êñá‰ª∂ÂõæÊ†áËß¶ÊéßÊ∏ÖÈõ∂
             -  
1898   6                                    }
1899   5      
1900   5                                    gCtrlPara.FileCount = 0;
1901   5                                } 
1902   4                        }
1903   3                        
1904   3                
1905   3      
1906   3                 }
1907   2              }     
1908   1      }
C51 COMPILER V9.60.0.0   UI                                                                12/09/2022 13:55:09 PAGE 32  

1909          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =  12034    ----
   CONSTANT SIZE    =     57    ----
   XDATA SIZE       =   ----      13
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
