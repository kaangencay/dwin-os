C51 COMPILER V9.60.0.0   MAIN                                                              12/09/2022 13:51:59 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE source\main.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\driver;.\source) D
                    -EBUG OBJECTEXTEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "timer.h"
   2          #include "ui.h"
   3          #include "uart.h"
   4          #include "dwin8283.h"
   5          #include "canbus.h"
   6          #include "ssd2828.h"
*** WARNING C235 IN LINE 70 OF source\ssd2828.h: parameter 1: different types
   7          #include "rtc.h"
   8          
   9          
  10          #include "vars.h"
  11          #include "ReceiveData.h"
  12          #include "MYModBus.h"
  13          
  14          //IOÒý½Å³õÊ¼»¯
  15          void io_init()
  16          {
  17   1        PORTDRV = 0x01;//Çý¶¯µçÁ÷Îª8mA
  18   1        //P1MDOUT |= 0x02;//½«P1.1ÉèÖÃÎªÊä³ö,ÓÃÓÚÇý¶¯LED1µÆ
  19   1        //P1MDOUT &= 0xFE;//½«P1.0ÉèÖÃÎªÊäÈë,ÓÃÓÚ¶ÁÈ¡Òý½ÅµÄµçÆ½±ä»¯
  20   1        
  21   1        //sbit csx = P1^0;    //p1.0
  22   1        //sbit sdo = P1^1;    //p1.1
  23   1        //sbit sdi = P1^2;    //p1.2
  24   1        //sbit sck = P1^3;    //p1.3
  25   1        //sbit sdc = P1^4;    //p1.4
  26   1        
  27   1        P1MDOUT = 0x1D; 
  28   1      }
  29          
  30          void main()
  31          {
  32   1      //  unsigned char head[2];
  33   1        
  34   1        INIT_CPU();                 //CPU ³õÊ¼»¯£¬×¢Òâ³õÊ¼»¯¹ý³ÌÖÐ»á°ÑËùÓÐxdata±äÁ¿³õÊ¼»¯³É0¡£Èç¹ûÉùÃ÷µÄ±äÁ¿ÓÐ³õÊ¼Ö
             -µ£¬ÐèÒªÔÚ¸Ãº¯ÊýºóÃæÖØÐÂ¸³Öµ
  35   1        T0_Init();            //¶¨Ê±Æ÷0³õÊ¼»¯
  36   1        Pro8283Init();
  37   1        init_rtc();
  38   1        EA = 1;
  39   1        StartTimer(0,20);
  40   1        StartTimer(1,10);
  41   1        
  42   1        //-------------------
  43   1        io_init();
  44   1        delay_ms(1000);
  45   1        ssd2828_init();
  46   1        //-------------------
  47   1        rdtime();
  48   1        
  49   1        UartInit(UART4,9600); 
  50   1        Vars_Initialize();
  51   1        Sta_Init();
  52   1        
C51 COMPILER V9.60.0.0   MAIN                                                              12/09/2022 13:51:59 PAGE 2   

  53   1        while(1)
  54   1        {
  55   2      //    if(SysTick_RTC >= 500)
  56   2      //    {
  57   2      //      rdtime();               //¸üÐÂÓ²¼þRTCÊ±¼ä
  58   2      //      SysTick_RTC = 0;
  59   2      //    }
  60   2      //    
  61   2      //    read_dgus_vp(0x9C,head,1);
  62   2      //    if(head[0] == 0x5A && head[1] == 0xA5)
  63   2      //    {
  64   2      //      //SBUF0 = temp[0];
  65   2      //      Write_RTC(0x9D,0x9E);
  66   2      //    }
  67   2      //    head[0] = 0;
  68   2      //    head[1] = 0;
  69   2      //    write_dgus_vp(0x9C,head,1);
  70   2          
  71   2          if(GetTimeOutFlag(0))
  72   2          {
  73   3            PageFunction();//Ã¿Ò»Ò³¶ÔÓ¦×Ô¼ºµÄÒ»¸ö×Óº¯Êý¡£ÓÐ½çÃæµÄ¿ª·¢Ê¹ÓÃ¸Ã¿ò¼Ü
  74   3            StartTimer(0,20);
  75   3          }
  76   2          if(GetTimeOutFlag(1))
  77   2          {
  78   3            Pro8283Deal();
  79   3            StartTimer(1,10);
  80   3          } 
  81   2      //    CanErrorReset();
  82   2          
  83   2          Receive_Modbus();
  84   2          
  85   2        }
  86   1      }
  87          
  88          //³õÊ¼»¯Ïà¹Ø²ÎÊýºÍÍ¼±ê
  89          void Sta_Init(void)
  90          {
  91   1        u16 Dat;
  92   1        
  93   1        //¹Ì¶¨¼Ä´æÆ÷³õÊ¼»¯
  94   1        Dat = 0x0000;
  95   1        sys_write_vp(0x1000,(u8*)&Dat,1);
  96   1        Dat = 0x005A;
  97   1        sys_write_vp(0x1001,(u8*)&Dat,1);
  98   1        Dat = 0xFF00;
  99   1        sys_write_vp(0x1002,(u8*)&Dat,1);
 100   1        Dat = 0x0001;
 101   1        sys_write_vp(0x1003,(u8*)&Dat,1);
 102   1        
 103   1        gCtrlPara.Memory = 0x0001;//ÄÚ´æ
 104   1        
 105   1        sys_write_vp(HMI_Current_Control,(u8*)&gCtrlPara.Current_Control,1);  //ÎÄ¼þÉÏµç¶Áµ±Ç°¿ØÖÆÒ³1
 106   1        
 107   1      
 108   1        
 109   1        Dat = 0x0001;
 110   1        sys_write_vp(0x10A1,(u8*)&Dat,1);
 111   1        sys_write_vp(0x10A2,(u8*)&Dat,1);
 112   1        sys_write_vp(0x10A3,(u8*)&Dat,1);
 113   1        sys_write_vp(0x10A4,(u8*)&Dat,1);
 114   1        sys_write_vp(0x10A5,(u8*)&Dat,1);
C51 COMPILER V9.60.0.0   MAIN                                                              12/09/2022 13:51:59 PAGE 3   

 115   1        sys_write_vp(0x10A6,(u8*)&Dat,1);
 116   1        
 117   1      
 118   1      }
 119          
 120          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    395    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       2
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
